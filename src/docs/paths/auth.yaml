paths:
  /auth/login:
    post:
      summary: Login with email and password
      tags: [Auth]
      security: []  # public
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '../components/auth.yaml#/schemas/AuthLoginRequest' }
      responses:
        '200':
          description: Login OK (session cookie set)
          content:
            application/json:
              schema: { $ref: '../components/auth.yaml#/schemas/AuthTokenResponse' }
        '401':
          description: Invalid credentials

  /auth/me:
    get:
      summary: Current user profile
      tags: [Auth]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '../components/auth.yaml#/schemas/AuthMeResponse' }
        '401':
          description: Unauthorized

  /auth/logout:
    post:
      summary: Logout current session
      tags: [Auth]
      responses:
        '200':
          description: Session ended successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message: { type: string, example: logged_out }
        '401':
          description: Not logged in

  /auth/register:
    post:
      summary: Bootstrap registration (first user only)
      description: Creates the initial admin when there are no users. Afterwards returns 403.
      tags: [Auth]
      security: []  # public
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, email, password]
              properties:
                name: { type: string, maxLength: 120 }
                email: { type: string, format: email, maxLength: 160 }
                password: { type: string, minLength: 8 }
      responses:
        '201':
          description: Registered and logged in (session cookie set)
        '403':
          description: Registration disabled after bootstrap
        '409':
          description: Email already registered
